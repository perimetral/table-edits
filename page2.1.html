<html>
<head>
	<meta charset="utf-8">
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script type="text/javascript" src="table-edits.js"></script>

	<style>
		table,td, th {
			border:1px solid black;
		}

		td {
			padding: 5px;
			width: 200px;
		}

		.something {
			background-color: yellow;
		}

	     .custom {
			border:1px solid red;
		}

		.inline-action-cancel {
			display: none;
		}
	</style>
</head>
<body>

<select id="fakeValidation">
  <option value="0">Validation Failed</option>
  <option value="1">Validation Passed</option>
</select>

	<table>
		<thead>
			<tr>
				<th>Name A</th>
				<th>Name B</th>
				<th></th>
			</tr>
		</thead>


		<tr>
			<td data-field="name_a">Hello World Row 1</td>
			<td data-field="name_b" data-field-class="custom" data-field-type="textarea">Super World Row 2</td>
			<td>
				<button type="button" class="inline-action-edit">Edit</button>
				<button type="button" class="inline-action-cancel">Cancel</button>
			</td>
		</tr>
		<tr>
			<td data-field="name_a">Hello World Row 2</td>
			<td data-field="name_b">Super World Row 2</td>
			<td>
				<button type="button" class="inline-action-edit">Edit</button>
				<button type="button" class="inline-action-cancel">Cancel</button>
			</td>
		</tr>
	</table>
</body>
</html>

<script>



	$(function () {

		


		let ed = $("table tr").editable({
			buttonSelector: ".inline-action-edit",
			defaultClass: 'something',


			validator: (values) => {

				var validation = $('#fakeValidation').val();

				if (validation == "1") {
					return true
				}

				return false;
			},

			edit: function (values) {
				alert("edit callback");
				$('.inline-action-edit', this).text("Save");

				 var tr = $(this).closest('tr');
				 tr.find('.inline-action-cancel').show();
			},

			save: function (values) {
				alert("save callback");

				$('.inline-action-edit', this).text("Edit");

				var tr = $(this).closest('tr');
				tr.find('.inline-action-cancel').hide();
			},

			cancel: function (values) {
			  	alert("cancel callback"); 
			  	$('.inline-action-edit', this).text("Edit");
			  	// Render Input back to orginal Text 

			  	var tr = $(this).closest('tr');
				tr.find('.inline-action-cancel').hide();
			  }
			});
		$("table tr").on('click', '.inline-action-cancel', function () {
                var tr = $(this).closest('tr');
                var inputText = $(tr).find("input").first().focus();
                var eventKey = jQuery.Event("keydown");
                eventKey.which = 27;
                $(inputText).trigger(eventKey);
       });
	});
</script>